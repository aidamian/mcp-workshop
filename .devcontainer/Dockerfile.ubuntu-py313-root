FROM python:3.13-alpine

RUN apk update \
    && apk add --no-cache \
        bash \
        build-base \
        ca-certificates \
        curl \
        git \
        libffi-dev \
        libnsl \
        libxml2-dev \
        libxslt-dev \
        linux-headers \
        nodejs \
        npm \
        openssh-client \
        openssl-dev \
        readline-dev \
        sqlite-dev \
        sudo \
        tzdata \
        xz \
        zlib-dev

RUN curl -LsSf https://astral.sh/uv/install.sh | UV_INSTALL_DIR=/usr/local/bin sh

RUN mkdir -p /workspaces

COPY requirements.txt /tmp/requirements.txt
RUN uv pip install --system -r /tmp/requirements.txt \
    && rm /tmp/requirements.txt

RUN npm install -g npm@latest @openai/codex

WORKDIR /workspaces

CMD ["/bin/bash"]
